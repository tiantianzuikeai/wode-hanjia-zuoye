<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>接香蕉</title>
		<style type="text/css">
			html {
				height: 100%;
			}
			
			body {
				height: 100%;
			}
			
			* {
				margin: 0;
				padding: 0;
			}
			
			#dragDiv {
				width: 200px;
				height: 200px;
				position: absolute;
				top: 650px;
				left: 100px;
				background: url(img/小黄人.png);
				background-repeat: no-repeat;
			}
			
			#fenshu {
				color: aqua;
				font-size: 40px;
				float: left;
			}
			
			#shijian {
				color: red;
				font-size: 40px;
				float: right;
			}
		</style>
	</head>

	<body style="background: orchid">
		<div id="fenshu"></div>
		<div id="shijian">60秒</div>
		<div id="dragDiv"></div>
		<script type="text/javascript">
			var t;
			var sum = 0;
			var t = 60;
			var x;
			var snowsrc = "img/香蕉.png"
			var no = 5;
			//声明变量，xp表示横坐标，yp表示纵坐标>
			var dx, xp, yp;
			//声明变量，am表示左右摆动的幅度，stx表示横坐标的偏移步长，sty表示纵坐标的步长>
			var am, stx, sty;
			//获取当前窗口的宽度
			var clientWidth = document.body.clientWidth;
			//获取当前窗口的高度
			var clientHeight = document.body.clientHeight;
			var dx = new Array();
			var xp = new Array();
			var yp = new Array();
			var am = new Array();
			var stx = new Array();
			var sty = new Array();
			var x1 = 0;
			var snowFlakes = new Array();
			for (i = 0; i < no; ++i) {
				dx[i] = 0;
				//第i个图片的横坐标初始值
				xp[i] = Math.random() * (clientWidth - 50);
				yp[i] = Math.random() * clientHeight; //第i个图片的纵坐标初始值
				am[i] = Math.random() * 20; //第i个图片的左右摆动的幅度
				stx[i] = 0.02 + Math.random() / 10;
				//第i个图片x方向的步长
				sty[i] = 4 + Math.random(); //第i个图片y方向的步长
				//生成一个容纳香蕉图片的div，并设置其绝对坐标
				var snowFlakeDiv = document.createElement('div');
				snowFlakeDiv.setAttribute('id', 'dot' + i);
				snowFlakeDiv.style.position = 'absolute';
				snowFlakeDiv.style.top = "15px";
				snowFlakeDiv.style.left = "15px";
				//生成一个香蕉图片对象，设置宽高，并加入div
				var snowFlakeImg = document.createElement('img');
				snowFlakeImg.setAttribute('src', snowsrc);
				snowFlakeImg.style.width = "50px";
				snowFlakeImg.style.height = "tfv 50px";
				//将香蕉div加入到document中，并通过数组保存
				snowFlakeDiv.appendChild(snowFlakeImg);
				document.body.appendChild(snowFlakeDiv);
				snowFlakes[i] = snowFlakeDiv;
			};
			//调用snowIE()函数 
			snow();

			function snow() {
				for (i = 0; i < no; ++i) {
					//第i个图片的纵坐标加上步长
					yp[i] += sty[i];
					//如果新坐标超过了屏幕下沿，重置该图片的信息，包括横坐标、纵坐标以及x方向的步长和y方向的步长
					dx[i] += stx[i]; //dx变量加上一个步长
					if (yp[i] > clientHeight * 0.8 && parseInt(xp[i] / 100) == parseInt(x1 / 100)) {
						sum++;
						yp[i] = 0;
						document.getElementById("fenshu").innerHTML = "获得了" + sum + "个"
					}
					if (yp[i] > clientHeight) {
						//重新赋值图片的横坐标
						xp[i] = Math.random() * (clientWidth - am[i] - 50);
						yp[i] = 0;
					}
					//直接操作数组中对应的香蕉div
					var snowFlakeDiv = snowFlakes[i];
					//更新图片的纵坐标
					snowFlakeDiv.style.top = yp[i] + "px";
					//更新图片的横坐标
					snowFlakeDiv.style.left = xp[i] + am[i] * Math.sin(dx[i]) + "px";
				}
				//设定动画刷新的时间周期
				setTimeout("snow()", 20);
			};
			var dragDiv = document.getElementById('dragDiv');
			//鼠标按下动作
			dragDiv.onmousedown = function(event) {
				var e = event || window.event,
					t = e.target || e.srcElement,
					//鼠标按下时的坐标x1,y1
					x1 = e.clientX,
					y1 = e.clientY,
					//鼠标按下时的左右偏移量
					dragLeft = this.offsetLeft,
					dragTop = this.offsetTop;
				document.onmousemove = function(event) {
					var e = event || window.event,
						t = e.target || e.srcElement,
						//鼠标移动时的动态坐标
						x2 = e.clientX,
						y2 = e.clientY,
						//鼠标移动时的坐标的变化量
						x = x2 - x1,
						y = y2 - y1;
					dragDiv.style.left = (dragLeft + x) + 'px';
					dragDiv.style.top = 650 + 'px';
				}
				document.onmouseup = function() {
					this.onmousemove = null;
				}
			}
			timer = setInterval("time()", 1000);

			function time() {
				t = t - 1;
				if (t < 0) {
					return false;
				}
				document.getElementById("shijian").innerHTML = t + '秒';
			};
			document.getElementById("fenshu").innerHTML = "获得了" + sum + "个"
		</script>
	</body>

</html>